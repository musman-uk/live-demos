<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>âœ… To Do List</title>
  <script src="https://cdn.jsdelivr.net/pyodide/v0.23.4/full/pyodide.js" defer></script>
  <style>
    body {
      background: #111;
      color: #fff;
      font-family: "Courier New", monospace;
      margin: 0;
      height: 100vh;
      font-size: 0.9em;
    }
    #terminal {
      position: relative;
      background: #000;
      height: 100vh;
      padding: 10px;
      border-top: 2px solid #444;
      box-sizing: border-box;
    }
    #header { margin-bottom: 1em; white-space: pre-wrap; }
    #output {
      white-space: pre-wrap;
      overflow-y: auto;
      height: calc(100vh - 10px - 10px - 1em - 48px);
      scrollbar-width: none;
    }
    #output::-webkit-scrollbar { display: none; }
    #output::after { content: ""; display: block; height: 64px; }
    #input-line {
      position: absolute; bottom: 0; left: 0; right: 0;
      padding: 10px; background: #000; border-top: 1px solid #333;
      display: flex; align-items: center; height: 48px;
    }
    #prompt { margin-right: 6px; }

    /* --- Fake block cursor --- */
    #command {
      outline: none;
      white-space: pre;
      caret-color: transparent;
      display: inline-block;
      min-width: 1ch;
    }
    #command::after {
      content: "";
      display: inline-block;
      width: 8px;
      height: 1em;
      background: #fff;
      animation: blink 1s steps(1) infinite;
      vertical-align: bottom;
    }
    @keyframes blink {
      50% { background: transparent; }
    }
  </style>
</head>
<body>
  <div id="terminal">
    <div id="header"></div>
    <div id="output">
Welcome to To Do List  

Options:  

1. Add Task  

2. Remove Task  

3. Quit  

Enter Your Choice, 1, 2, or 3       
    </div>
    <div id="input-line">
      <span id="prompt">>>> </span>
      <span id="command" contenteditable="true"></span>
    </div>
  </div>

  <!-- Python logic -->
  <script type="text/python" id="py-code">
todo_list = []

def show_list():
    if todo_list:
        for i, task in enumerate(todo_list, 1):
            print(f"{i}. {task}")
    print()

def add_task(task):
    todo_list.append(task)
    print(f"Task '{task}' added to the To Do List")
    print()

def remove_task():
    if todo_list:
        removed = todo_list.pop()
        print(f"Task '{removed}' removed from the To Do List")
    else:
        print("Your To Do List is empty")
    print()
  </script>

  <script>
    /* --- Banner --- */
    function formatDate() {
      const now = new Date();
      return `${now.toDateString()} ${now.getHours().toString().padStart(2,"0")}:${now.getMinutes().toString().padStart(2,"0")}`;
    }
    function updateHeader() {
      document.getElementById("header").textContent =
`Python 3.15.0 (main, ${formatDate()}) [Clang 14.0.0]
Type "help", "copyright", "credits" or "license" for more information.`;
    }
    updateHeader(); setInterval(updateHeader, 60000);

    /* --- Pyodide bootstrap (deferred) --- */
    let pyodideInstance = null;
    let commandQueue = [];
    (async () => {
      let pyodide = await loadPyodide();
      await pyodide.runPythonAsync(document.getElementById("py-code").textContent);
      pyodideInstance = pyodide;
      // Replay any queued commands
      for (let cmd of commandQueue) runCommand(cmd);
      commandQueue = [];
    })();

    let awaitingTask = false;

    function appendAndStick(text) {
      const out = document.getElementById("output");
      out.textContent += text;
      out.scrollTop = out.scrollHeight;
    }

    async function runCommand(cmd) {
      if (!pyodideInstance) {
        // Buffer until Pyodide is ready
        commandQueue.push(cmd);
        return;
      }
      let pyodide = pyodideInstance;
      let output = "";
      pyodide.setStdout({ batched: s => output += s });

      if (awaitingTask) {
        await pyodide.runPythonAsync(`add_task(${JSON.stringify(cmd)})`);
        awaitingTask = false;
        appendAndStick(`\n>>> ${cmd}\n\n${output}`);
        return;
      }

      if (cmd === "1") {
        output = "Adding task\n\nEnter the task:";
        awaitingTask = true;
      } else if (cmd === "2") {
        output = "Removing task\n\n";
        await pyodide.runPythonAsync("remove_task()");
      } else if (cmd === "3") {
        await pyodide.runPython
