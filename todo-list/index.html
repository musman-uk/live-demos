<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>âœ… To Do List</title>
  <script src="https://cdn.jsdelivr.net/pyodide/v0.23.4/full/pyodide.js"></script>
  <style>
    /* --- Terminal look & feel --- */
    body {
      background: #111;
      color: #fff;
      font-family: "Courier New", monospace;
      margin: 0;
      height: 100vh;
      font-size: 0.9em;
    }
    #terminal {
      position: relative;
      background: #000;
      height: 100vh;
      padding: 10px;
      border-top: 2px solid #444;
      box-sizing: border-box;
    }
    #header { margin-bottom: 1em; white-space: pre-wrap; }
    #output {
      white-space: pre-wrap;
      overflow-y: auto;
      height: calc(100vh - 10px - 10px - 1em - 48px);
      scrollbar-width: none;
    }
    #output::-webkit-scrollbar { display: none; }
    #output::after { content: ""; display: block; height: 64px; }
    #input-line {
      position: absolute; bottom: 0; left: 0; right: 0;
      padding: 10px; background: #000; border-top: 1px solid #333;
      display: flex; align-items: center; height: 48px;
    }
    #prompt { margin-right: 6px; }

    /* --- Fake block cursor --- */
    #command {
      outline: none;
      white-space: pre;
      caret-color: transparent;   /* hide native caret */
      display: inline-block;
      min-width: 1px;             /* keeps span clickable when empty */
    }
    #command::after {
      content: "";
      display: inline-block;
      width: 8px;
      height: 1em;
      background: #fff;
      animation: blink 1s steps(1) infinite;
      vertical-align: bottom;     /* keep aligned with text baseline */
    }
    @keyframes blink {
      50% { background: transparent; }
    }
  </style>
</head>
<body>
  <div id="terminal">
    <div id="header"></div>
    <div id="output">
Welcome to To Do List  

Options:  

1. Add Task  

2. Remove Task  

3. Quit  

Enter Your Choice, 1, 2, or 3       
    </div>
    <div id="input-line">
      <span id="prompt">>>> </span>
      <span id="command" contenteditable="true"></span>
    </div>
  </div>

  <!-- Python logic for tasks -->
  <script type="text/python" id="py-code">
todo_list = []

def show_list():
    if todo_list:
        for i, task in enumerate(todo_list, 1):
            print(f"{i}. {task}")
    print()

def add_task(task):
    todo_list.append(task)
    print(f"Task '{task}' added to the To Do List")
    print()

def remove_task():
    if todo_list:
        removed = todo_list.pop()
        print(f"Task '{removed}' removed from the To Do List")
    else:
        print("Your To Do List is empty")
    print()
  </script>

  <script>
    /* --- Dynamic Python banner --- */
    function formatDate() {
      const now = new Date();
      return `${now.toDateString()} ${now.getHours().toString().padStart(2,"0")}:${now.getMinutes().toString().padStart(2,"0")}`;
    }
    function updateHeader() {
      document.getElementById("header").textContent =
`Python 3.15.0 (main, ${formatDate()}) [Clang 14.0.0]
Type "help", "copyright", "credits" or "license" for more information.`;
    }
    updateHeader(); setInterval(updateHeader, 60000);

    /* --- Pyodide bootstrap --- */
    let pyodideInstance = (async () => {
      let pyodide = await loadPyodide();
      await pyodide.runPythonAsync(document.getElementById("py-code").textContent);
      return pyodide;
    })();

    let awaitingTask = false;

    function appendAndStick(text) {
      const out = document.getElementById("output");
      out.textContent += text;
      out.scrollTop = out.scrollHeight;
    }

    async function runCommand(cmd) {
      let pyodide = await pyodideInstance;
      let output = "";
      pyodide.setStdout({ batched: s => output += s });

      if (awaitingTask) {
        await pyodide.runPythonAsync(`add_task(${JSON.stringify(cmd)})`);
        awaitingTask = false;
        appendAndStick(`\n>>> ${cmd}\n\n${output}`);
        return;
      }

      if (cmd === "1") {
        output = "Adding task\n\nEnter the task:";
        awaitingTask = true;
      } else if (cmd === "2") {
        output = "Removing task\n\n";
        await pyodide.runPythonAsync("remove_task()");
      } else if (cmd === "3") {
        await pyodide.runPythonAsync("todo_list.clear()");
        output = "Quitting\n\nYour To Do List is empty";
      } else if (cmd === "help") {
        output = "Type the number of an option to execute it.\n\n1 = Add a task\n2 = Remove the last task\n3 = Quit the program";
      } else if (cmd === "credits") {
        output = "This was originally created on Mimo.";
      } else if (cmd === "copyright") {
        output = "Copyright (c) 2001-2025 Python Software Foundation.\nAll Rights Reserved.";
      } else if (cmd === "license") {
        output = "Python is distributed under the PSF License.\nSee https://docs.python.org/3/license.html for details.";
      } else {
        output = "Invalid choice";
      }

      appendAndStick(`\n>>> ${cmd}\n\n${output}`);
    }

    /* --- Input listener --- */
    const cmdEl = document.getElementById("command");
    cmdEl.addEventListener("keydown", e => {
      if (e.key === "Enter") {
        e.preventDefault();
        const cmd = e.target.innerText.trim().toLowerCase();
        e.target.innerText = "";
        runCommand(cmd);
      }
    });

    /* --- Auto-focus so typing works immediately --- */
    window.addEventListener("load", () => {
      cmdEl.focus();
    });
  </script>
</body>
</html>
