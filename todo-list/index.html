<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>âœ… To Do List</title>
  <!-- MicroPython WASM runtime -->
  <script src="https://micropython.org/resources/micropython.js"></script>
  <style>
    /* --- Terminal look --- */
    body { background:#111; color:#fff; font-family:"Courier New",monospace; margin:0; height:100vh; font-size:0.9em; }
    #terminal { position:relative; background:#000; height:100vh; padding:10px; border-top:2px solid #444; box-sizing:border-box; }
    #header { margin-bottom:1em; white-space:pre-wrap; }
    #output { white-space:pre-wrap; overflow-y:auto; height:calc(100vh - 10px - 10px - 1em - 48px); }
    #output::-webkit-scrollbar { display:none; }
    #input-line { position:absolute; bottom:0; left:0; right:0; padding:10px; background:#000; border-top:1px solid #333; display:flex; align-items:center; height:48px; }
    #prompt { margin-right:6px; }
    /* --- Fake block cursor --- */
    #command { outline:none; white-space:pre; caret-color:transparent; display:inline-block; min-width:1ch; }
    #command::after { content:""; display:inline-block; width:8px; height:1em; background:#fff; animation:blink 1s steps(1) infinite; vertical-align:bottom; }
    @keyframes blink { 50%{background:transparent;} }
  </style>
</head>
<body>
  <div id="terminal">
    <div id="header"></div>
    <div id="output">
Welcome to To Do List  

Options:  
1. Add Task  
2. Remove Task  
3. Quit  

Enter Your Choice, 1, 2, or 3       
    </div>
    <div id="input-line">
      <span id="prompt">>>> </span>
      <span id="command" contenteditable="true"></span>
    </div>
  </div>

  <!-- Original Mimo Python logic (unchanged) -->
  <script id="py-code" type="text/plain">
_output = []
def py_print(*args): _output.append(" ".join(str(a) for a in args))
def flush_output():
    s = "\n".join(_output); _output.clear(); return s

todo_list = []
def show_list():
    if todo_list:
        for i, task in enumerate(todo_list, 1): py_print(f"{i}. {task}")
    py_print("")
def add_task(task):
    todo_list.append(task); py_print(f"Task '{task}' added to the To Do List"); py_print("")
def remove_task():
    if todo_list: py_print(f"Task '{todo_list.pop()}' removed from the To Do List")
    else: py_print("Your To Do List is empty")
    py_print("")
  </script>

  <script>
    /* --- Banner dressing --- */
    function formatDate(){ const n=new Date(); return `${n.toDateString()} ${n.getHours().toString().padStart(2,"0")}:${n.getMinutes().toString().padStart(2,"0")}`; }
    function updateHeader(){
      document.getElementById("header").textContent=
`Python 3.15.0 (main, ${formatDate()}) [Clang 14.0.0]
Type "help", "copyright", "credits" or "license"`;
    }
    updateHeader(); setInterval(updateHeader,60000);

    /* --- Helpers --- */
    const cmdEl=document.getElementById("command");
    function sanitizeInput(raw){ return raw.replace(/[\u200B\u200C\u200D]/g,"").replace(/\u00A0/g," ").trim().toLowerCase(); }
    function normalizeCommand(){ if(cmdEl.innerText==="") cmdEl.textContent=" "; }
    function appendAndStick(txt){ const out=document.getElementById("output"); out.textContent+=txt; out.scrollTop=out.scrollHeight; }

    /* --- MicroPython init --- */
    let mpReady=false, awaitingTask=false;
    window.mp_js_stdout_buffer=""; window.mp_js_stdout=s=>{ window.mp_js_stdout_buffer+=s; };
    function initMicroPython(){ mp_js_init(128*1024); mp_js_do_str(document.getElementById("py-code").textContent); mpReady=true; }

    /* --- Command handler --- */
    function runCommand(raw){
      const cmd=sanitizeInput(raw); if(!cmd||!mpReady) return;
      let output="";
      if(awaitingTask){
        mp_js_do_str(`add_task(${JSON.stringify(cmd)})`); awaitingTask=false;
        mp_js_do_str("print(flush_output())"); output=window.mp_js_stdout_buffer; window.mp_js_stdout_buffer="";
        appendAndStick(`\n>>> ${cmd}\n\n${output}`); return;
      }
      if(cmd==="1"){ output="Adding task\n\nEnter the task:"; awaitingTask=true; }
      else if(cmd==="2"){ mp_js_do_str("remove_task()"); mp_js_do_str("print(flush_output())"); output=window.mp_js_stdout_buffer; window.mp_js_stdout_buffer=""; }
      else if(cmd==="3"){ mp_js_do_str("todo_list.clear()"); output="Quitting\n\nYour To Do List is empty"; }
      else if(cmd==="help"){ output="Type the number of an option to execute it.\n\n1 = Add a task\n2 = Remove the last task\n3 = Quit the program"; }
      else if(cmd==="credits"){ output="This was originally created on Mimo."; }
      else if(cmd==="copyright"){ output="Copyright (c) 2001-2025 Python Software Foundation.\nAll Rights Reserved."; }
      else if(cmd==="license"){ output="Python is distributed under the PSF License.\nSee https://docs.python.org/3/license.html for details."; }
      else{ output="Invalid choice"; }
      appendAndStick(`\n>>> ${cmd}\n\n${output}`);
    }

    /* --- Input handling --- */
    cmdEl.addEventListener("keydown",e=>{
      if(e.key==="Enter"){ e.preventDefault(); const raw=cmdEl.innerText; cmdEl.textContent=" "; runCommand(raw); }
    });
    cmdEl.addEventListener("input",normalizeCommand);

    /* --- Auto-focus --- */
    window.addEventListener("load",()=>{ normalizeCommand(); cmdEl.focus(); initMicroPython(); });
    document.getElementById("terminal").addEventListener("click",()=>cmdEl.focus());
  </script>
</body>
</html>
