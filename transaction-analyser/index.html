<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Transaction Analyser</title>
  <script src="https://cdn.jsdelivr.net/pyodide/v0.23.4/full/pyodide.js"></script>
  <style>
    body {
      background: #111;
      color: #0f0;
      font-family: "Courier New", monospace;
      padding: 20px;
    }
    #terminal {
      border: 1px solid #444;
      padding: 10px;
      background: #000;
      min-height: 150px;
      white-space: pre-wrap;
    }
    button {
      margin: 5px;
      background: #222;
      color: #0f0;
      border: 1px solid #0f0;
      padding: 5px 10px;
      cursor: pointer;
      font-family: inherit;
    }
    button:hover {
      background: #0f0;
      color: #000;
    }
  </style>
</head>
<body>
  <h2>Transaction Analyser (Pythonâ€‘powered)</h2>
  <p>Select a transaction type:</p>
  <button onclick="runPython(1)">1. Deposit</button>
  <button onclick="runPython(2)">2. Withdrawal</button>
  <button onclick="runPython(3)">3. Transfer</button>

  <div id="terminal">>>> Ready for input...</div>

  <script type="text/python" id="py-code">
def analyse(choice: int) -> str:
    if choice == 1:
        return "Deposit selected. Funds added."
    elif choice == 2:
        return "Withdrawal selected. Funds deducted."
    elif choice == 3:
        return "Transfer selected. Funds moved."
    else:
        return "Invalid choice."
  </script>

  <script>
    let pyodideReadyPromise = loadPyodide();

    async function runPython(choice) {
      let pyodide = await pyodideReadyPromise;
      // Load the Python code block once
      if (!pyodide.globals.get("analyse")) {
        await pyodide.runPythonAsync(
          document.getElementById("py-code").textContent
        );
      }
      // Call the Python function
      let result = pyodide.globals.get("analyse")(choice);
      document.getElementById("terminal").textContent += 
        `\n>>> ${choice}\n${result}`;
    }
  </script>
</body>
</html>
